{% schema %}
{
  "name": "Custom Products Section",
  "settings": [
    {
      "type": "color",
      "id": "star_color",
      "label": "Star Color",
      "default": "#FFD700"
    },
    {
      "type": "text",
      "id": "heading_text",
      "label": "Heading Text",
      "default": "Welcome to Our Store"
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#333333"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "label": "Heading Font Size (px)",
      "min": 16,
      "max": 48,
      "default": 24
    },
    {
      "type": "text",
      "id": "subheading_text",
      "label": "Subheading Text",
      "default": "Quality Products at Great Prices"
    },
    {
      "type": "color",
      "id": "subheading_color",
      "label": "Subheading Color",
      "default": "#777777"
    },
    {
      "type": "range",
      "id": "subheading_font_size",
      "label": "Subheading Font Size (px)",
      "min": 12,
      "max": 36,
      "default": 18
    },
    {
      "type": "range",
      "id": "number_of_products",
      "label": "Number of Product Cards",
      "min": 1,
      "max": 10,
      "default": 3
    },
    {
      "type": "range",
      "id": "gap_above",
      "label": "Gap Above Products (in pixels)",
      "min": 0,
      "max": 100,
      "default": 20
    },
    {
      "type": "range",
      "id": "gap_below",
      "label": "Gap Below Products (in pixels)",
      "min": 0,
      "max": 100,
      "default": 20
    }
  ],
  "blocks": [
    {
      "type": "product_card",
      "name": "Product Card",
      "settings": [
        {
          "type": "product",
          "id": "product",
          "label": "Select Product"
        },
        {
          "type": "text",
          "id": "small_title",
          "label": "Small Title"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Subtitle"
        },
        {
          "type": "text",
          "id": "point_1",
          "label": "Point 1"
        },
        {
          "type": "text",
          "id": "point_2",
          "label": "Point 2"
        },
        {
          "type": "text",
          "id": "point_3",
          "label": "Point 3"
        },
        {
          "type": "text",
          "id": "point_4",
          "label": "Point 4"
        },
        {
          "type": "text",
          "id": "point_5",
          "label": "Point 5"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Custom Products",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<div class="custom-products" style="margin-top: {{ section.settings.gap_above }}px; margin-bottom: {{ section.settings.gap_below }}px;">
  <div class="stars" style="color: {{ section.settings.star_color }};">
    ★★★★★
  </div>
<h2 style="color: {{ section.settings.heading_color }}; font-size: {{ section.settings.heading_font_size }}px; margin: 5px auto;text-align:left; font-weight: 600; font-family: 'Outfit', sans-serif; text-align: center; max-width: 600px;">
  {{ section.settings.heading_text }}
</h2>

  <h3 style="color: {{ section.settings.subheading_color }}; font-size: {{ section.settings.subheading_font_size }}px; margin: 5px 0 20px 0;">
    {{ section.settings.subheading_text }}
  </h3>
  <div class="grid">
    {%- for block in section.blocks -%}
      {%- assign product = block.settings.product -%}
      <div class="product-card">
        <form method="post" action="/cart/add" class="ajax-add-to-cart">
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          <img src="{{ product.featured_image | img_url: '240x240' }}" alt="{{ product.title }}" class="product-image">
          <h3 class="product-name">{{ product.title }}</h3>
          <p class="product-price"><strong>{{ product.price | money }}</strong></p>
          <hr class="divider">
          <h4>{{ block.settings.small_title }}</h4>
          <h5>{{ block.settings.subtitle }}</h5>
          <p>Includes:</p>
          <ul class="includes-points">
            {%- for i in (1..5) -%}
              {%- capture point_key -%}point_{{ i }}{%- endcapture -%}
              {%- assign point = block.settings[point_key] -%}
              {%- if point != blank -%}
                <li>
                  {%- if i == 1 -%}
                    {{ point }} <!-- No tick for the first point -->
                  {%- else -%}
                    <span class="tick-mark">✔️</span> {{ point }} <!-- Tick for other points -->
                  {%- endif -%}
                </li>
              {%- endif -%}
            {%- endfor -%}
          </ul>
          <button type="submit" style="background-color: #6C86FE; border-radius: 30px; color: #FFFEF9; padding: 10px 20px; border: none;">
            Add to Cart
          </button>
        </form>
      </div>
    {%- endfor -%}
  </div>
</div>

<style>

.custom-products {
  display: flex;
  flex-direction: column;
  align-items: center; /* Center items horizontally */
  text-align: center;
  background: linear-gradient(180deg, rgba(255, 254, 249, 0.15) 0%, rgba(108, 134, 254, 0.15) 100%); /* Gradient background */
  padding: 60px; /* Optional: add padding */
  border-radius: 10px; /* Optional: add rounded corners */
}

.stars {
  font-size: 30px; /* Custom font size for stars */
  margin-bottom: 5px; /* Reduced space below stars */
}

.grid {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
}

.product-card {
  background-color: #FFFEF9; /* Solid background color for cards */
  border: 1px solid #6C86FE;
  border-radius: 10px;
  padding: 20px;
  text-align: center;
  width: 240px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.product-image {
  display: block;
  margin: 0 auto 10px; /* Center the image */
  max-width: 100%; /* Ensure the image fits within the card */
  height: auto; /* Maintain the image aspect ratio */
}

.product-name {
  font-size: 18px; /* Set product name font size */
  margin: 2px 0; /* Adjust margin */
}

.product-price {
  font-size: 38px; /* Set product price font size */
  margin: 2px 0; /* Reduce gap above and below the line */
}

.divider {
  border-top: 1px solid #6C86FE; 
  margin: 2px 0; /* Reduce gap above and below the line */
}

.includes-points {
  list-style-type: none; /* Remove default list style */
  padding: 0;
}

.includes-points li {
  display: flex;
  align-items: center; /* Align tick mark and text */
}

.tick-mark {
  margin-right: 5px; /* Space between tick mark and text */
  color: #000000; /* Optional: color for tick mark */
}
</style>

<script>
  document.querySelectorAll('.ajax-add-to-cart').forEach(form => {
    form.addEventListener('submit', function(event) {
      event.preventDefault(); // Prevent default form submission
      const formData = new FormData(form);

      fetch('/cart/add.js', {
        method: 'POST',
        body: formData,
        headers: {
          'Accept': 'application/json'
        }
      })
      .then(response => response.json())
      .then(data => {
        console.log('Product added:', data);
        alert('Product added to cart!'); // Notify the user
      })
      .catch((error) => {
        console.error('Error:', error);
      });
    });
  });
</script>